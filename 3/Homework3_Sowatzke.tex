\documentclass[fleqn]{article}

\usepackage{enumitem}
\usepackage[nodisplayskipstretch]{setspace}
\usepackage{amsmath, nccmath}
\usepackage{amssymb}
\usepackage{etoolbox}

\newcommand{\zerodisplayskip}{
	\setlength{\abovedisplayskip}{0pt}
	\setlength{\belowdisplayskip}{0pt}
	\setlength{\abovedisplayshortskip}{0pt}
	\setlength{\belowdisplayshortskip}{0pt}
	\setlength{\mathindent}{0pt}}
	
\makeatletter
\preto\equation{\@fleqnfalse}
\makeatother

%\makeatletter
%\preto\equation{\@fleqnfalse\singlespacing}
%\patchcmd{\equation}{\doublespacing\disablespaces}
%\makeatother

%\BeforeBeginEnvironment{align}{\begin{singlespace}}
%\AfterEndEnvironment{align}{\end{singlespace}\noindent\ignorespaces\disablespaces\disableparskip}

%\makeatletter
%\renewcommand{\equation{\@fleqnfalse}}{\endequation{\@fleqntrue}}
%\preto\equation{\@fleqnfalse}
%\makeatother

%\makeatletter
%\preto\align{\@fleqnflase}
%\makeatother

\title{Homework 3}
\author{Owen Sowatze}
\date{September 25, 2023}

\begin{document}
	
	\zerodisplayskip
	\doublespacing
	\maketitle
	
	\begin{enumerate}[nolistsep]
		\item[1.] Give an example of a function $\varphi : \mathbb{R}^2 \rightarrow \mathbb{R}$ such that
		
		$\varphi(av) = a\varphi(v)$
		
		for all $a \in \mathbb{R}$ and all $v \in \mathbb{R}^2$ but $\varphi$ is not linear.
		
		[\textit{The exercise above and the next exercise show that neither homogeneity nor additivity alone is enough to imply that a function is a linear map.}]
		
		Let $\varphi(v) = \varphi((x,y)) = \sqrt{x^2+y^2}$:
		
		$\varphi(av) = \varphi((ax,ay)) = \sqrt{(ax)^2 + (ay)^2} = \sqrt{a^2x^2 + a^2y^2}$
		
		$ = \sqrt{a^2(x^2 + y^2)} = a\sqrt{x^2+y^2} = a\varphi((x,y)) = a\varphi(v)$
		
		$\therefore \varphi$ satisfies homogeneity.
		
		Now check whether it satitisfies additivity:
		
		$\varphi(v_1+v_2) = \varphi((x_1+x_2,y_1+y_2)) = \sqrt{(x_1+x_2)^2 + (y_1+y_2)^2}$
		
		$\varphi(v_1) + \varphi(v_2) = \varphi((x_1,y_1)) + \varphi((x_2,y_2)) = \sqrt{x_1^2+y_1^2} + \sqrt{x_2^2+y_2^2}$
		
		$\varphi(v_1+v_2)$ is not equal to $\varphi(v_1) + \varphi(v_2)$ for all $v_1, v_2 \in \mathbb{R}^2$
		
		Consider $v_1 = (1, 0)$ and $v_2 = (0, 1)$:
		
		$\varphi(v_1+v_2) = \sqrt{1^2 + 1^2} = \sqrt{2}$
		
		$\varphi(v_1) + \varphi(v_2) = \sqrt{1^2 + 0^2} + \sqrt{0^2 + 1^2} = 1 + 1 = 2$
		
		$\varphi(v_1+v_2) \neq \varphi(v_1) + \varphi(v_2)$
		
		$\therefore \varphi$ does not satisfy additivity so it is not linear.
		
		\pagebreak
		\item[2.] Suppose $T \in \mathcal{L}(V,W)$ is injective and $v_1,...,v_n$ is linearly independent in $V$. Prove that $Tv_1,...,Tv_n$ is linearly independent in $W$.
		
	$T$ is injective iff $\text{null}\ T = \{0\}$.
	
	In other words, the only way to make $T(a_1v_1 + \cdots + a_nv_n)$\newline$= a_1Tv_1 + \cdots + a_nTv_n = 0$ is by forcing $a_1v_1 + \cdots + a_nv_n = 0$ 
	
	Because $v_1,...,v_n$ is linearly independent in $V$, the only way to make $a_1v_1 + \cdots + a_nv_n = 0$ is by setting $a_1 = \cdots = a_n = 0$.
	
	Combining this information, we can conclude that the only way to make $a_1Tv_1 + \cdots + a_nTv_n = 0$ is by setting $a_1 = \cdots = a_n = 0$.
	
	$\therefore Tv_1,...,Tv_n$ is linearly independent in $W$.
	
		\item[3.] Suppose $v_1,...v_n$ spans $V$ and $T \in \mathcal{L}(V,W)$. Prove that the list\newline $Tv_1,...,Tv_n$ spans $\text{range}\ T$.

		The $\text{range}\ T$ is defined as follows:
		
		$\text{range}\ T = \{Tv : v \in V\}$
		
		Because $v_1,...,v_n$ spans $V$, every $v \in V$ can be written as a linear combination of the vectors $v_1,...,v_n$:
		
		$v = a_1v_1 + \cdots + a_nv_n$ for $a_1,...,a_n \in \mathbb{F}$
		
		Using this result, every vector in the $\text{range}\ T$ can be written as follows:
		
		$Tv = T(a_1v_1 + \cdots a_nv_n) = a_1Tv_1 + \cdots + a_nTv_n$ for $a_1,...,a_n \in \mathbb{F}$
		
		Note that this is equivalent to the definition of a spanning list with every $v_i$ replaced with $Tv_i$ for $i = 1,....n$.
		
		$\therefore Tv_1,...,Tv_n$ spans $\text{range}\ T$.
		
		\item[4.] Suppose $V$ is finite-dimensional and $S,T \in \mathcal{L}(V)$. Prove that $ST = I$ if any only if $TS = I$.
		
	Proof of if ($\Rightarrow$):
	
	Let $ST = I$
	
	$I$ is invertible because $IA = I$ and $AI = I$, where $A = I$.
	
	Because $I$ is invertible, $ST$ is invertible.
	
	$\therefore \exists\ U \in \mathcal{L}(V)$ such that $U(ST) = I$ and $(ST)U = I$.
	
	Let $v \in V$ and $Tv = 0$
	
	$v = Iv = U(ST)v = US(Tv) = 0$
	
	$\therefore \text{null}\ T = \{0\} \Rightarrow T$ is injective.
	
	$\text{dim}\ V = \text{dim null}\ T + \text{dim range}\ T$
	
	$\Rightarrow \text{dim range}\ T = \text{dim}\ V \Rightarrow \text{range}\ T = V \Rightarrow T$ is surjective. 
	
	Because $T$ is injective and surjective, it is invertible.
	
	%Let $w \in V$
	
	%$w = Iw = (ST)Uw = S(TUw)$
	
	%$w \in \text{range}\ S$
	
	%Because $w$ is an arbitrarily chosen vector in $V$, $\text{range}\ S = V$.
	
	%$\Rightarrow S$ is surjective.
	
	%$\text{dim}\ V = \text{dim null}\ S + \text{dim range}\ S \Rightarrow \text{dim null}\ S = 0$
	
	%$\Rightarrow \text{null}\ S = \{0\} \Rightarrow S$ is injective.
	
	%Because $S$ is injective and surjective, it is invertible.
	
	Since $T$ is invertible, we can write $ST = I$ as
	
	$(ST)T^{-1} = IT^{-1}$
	
	$S(TT^{-1}) = T^{-1}$
	
	$SI = T^{-1}$
	
	$S = T^{-1}$
	
	$TS = TT^{-1}$
	
	$TS = I$
	
	Proof of only if ($\Leftarrow$):
	
	Let $TS = I$
	
	$I$ is invertible because $IA = I$ and $AI = I$, where $A = I$.
	
	Because $I$ is invertible, $TS$ is invertible.
	
	$\therefore \exists\ U \in \mathcal{L}(V)$ such that $U(TS) = I$ and $(TS)U = I$.
	
	Let $v \in V$ and $Sv = 0$
	
	$v = Iv = U(TS)v = UT(Sv) = 0$
	
	$\therefore \text{null}\ S = \{0\} \Rightarrow S$ is injective.
	
	$\text{dim}\ V = \text{dim null}\ S + \text{dim range}\ S$
	
	$\Rightarrow \text{dim range}\ S = \text{dim}\ V \Rightarrow \text{range}\ S = V \Rightarrow S$ is surjective.
	
	Because $S$ is injective and surjective, it is invertible.
	
	Since $S$ is invertible, we can write $TS = I$ as
	
	$(TS)S^{-1} = IS^{-1}$
	
	$T(SS^{-1}) = S^{-1}$
	
	$TI = S^{-1}$
	
	$T = S^{-1}$
	
	$ST = SS^{-1}$
	
	$ST = I$
	
	\item[5.] \textbf{Linear Filters:} Filters are commonly used in various applications, such as signal processing and communications, to condition the signal(s) for a particular purpose. Linear shift-invariant (LSI) filters, a special subset of filters, are designed to accomplish various spectral filtering operations, e.g., suppressing the high-frequencies in a signal, i.e., a low-pass filter, or rejecting a particular narrow band of frequencies, i.e., a notch-filter. In the continuous time-domain, a LSI filter operation is mathematically expressed as a convolution integral,
	
		\begin{equation}
			y(t) = \int{h(t-\tau)x(\tau)d\tau}
		\end{equation}
		
		where $x(t)$ is the input signal, $h(t)$ is the filter’s impulse response function, and $y(t)$ is the filter’s output signal. In the discrete-time setting or in the sampled, digital domain, the LSI filtering operation can be expressed as a convolution sum,
	
		\begin{equation}
			y(n) = \sum_{k=0}^{N-1}{h(n-k)x(k+1)}
			\label{dt_convolution}
		\end{equation}
		
		%\setlength{\abovedisplayskip}{0pt}
		%\setlength{\belowdisplayskip}{0pt}
		%\setlength{\abovedisplayshortskip}{0pt}
		%\setlength{\belowdisplayshortskip}{0pt}
		%\setlength{\mathindent}{0pt}
	
		where $x(n)$ is an input signal sequence of length N that can be expressed as an N-dimensional vector $x = (x_1, x_2, ..., x_N)^T$, the filter impulse response $h(n)$ is of length $M$, expressed as an M-dimensional vector $h = (h_1, h_2, ..., h_M)$ (typically, $M < N$), and the output signal signal y of length N, $y = (y_1, y_2, ..., y_N)^T$.
		
		\pagebreak
		\begin{enumerate}
			\item[a)] Show that a LSI filter, as defined in Equation (\ref{dt_convolution}), is a linear map $T : V \rightarrow W$, where $V = W = \mathbb{R}^N$ and $x,y \in \mathbb{R}^N$.
			
			For the LSI filter to be a linear map it must satisfy additivity and homogeneity.
			
			Let:
			
			\begin{align*}
				T(x) = y(n) = \sum_{k=0}^{N-1}{h(n-k)x(k+1)}
			\end{align*}
			
			\begin{align*}
				T(\bar{x}) = \bar{y}(n) = \sum_{k=0}^{N-1}{h(n-k)\bar{x}(k+1)}
			\end{align*}
			
			\begin{align*}
				T(x + \bar{x}) = \sum_{k=0}^{N-1}{h(n-k)\{x(k+1) + \bar{x}(k+1)\}}
			\end{align*}
			
			\begin{align*}
				 = \sum_{k=0}^{N-1}{h(n-k)x(k+1)} + \sum_{k=0}^{N-1}{h(n-k)\bar{x}(k+1)} = T(x) + T(\bar{x})
			\end{align*}
			
			$\Rightarrow$ The LSI filter satisfies additivity.
			
			Let $\lambda \in \mathbb{R}$ and
			
			\begin{align*}
				T(x) = y(n) = \sum_{k=0}^{N-1}{h(n-k)x(k+1)}
			\end{align*}
			
			\begin{align*}
				T(\lambda x) = \sum_{k=0}^{N-1}{h(n-k)\{\lambda x(k+1)\}}
			\end{align*}
			
			\begin{align*}
			= \lambda\sum_{k=0}^{N-1}{h(n-k) x(k+1)} = \lambda T(x)
			\end{align*}
			
			$\Rightarrow$ The LSI filter satisfies homogeneity.
			
			Because the LSI filter satisfies additivity and homogeneity, it is a linear map.
			
			\pagebreak
			\item[b)] Express the LSI filter's linear map $H$ as an $N \times N$ matrix $\mathbf{H}$ such that
			
			\begin{center}
				$y = \mathbf{H}x$
			\end{center}
			
			Here you can assume that $h(m) = 0$ for $m \not\in \{1,2,3,...,M\}$.
			
			Hint: Expand an output vector that results from applying the map (operating) on a basis vector of $V$, in the basis of $V$. The coefficients of this expansion produce the column vectors of the matrix. You can use the standard basis.

			Let the $v_1,...,v_n$ be the standard basis vectors of $V$, i.e.
			
			$v_1 = (1, 0,...,0)^T$
			
			$v_2 = (0, 1,...,0)^T$
			
			$\vdots$
			
			$v_N = (0, 0,...,1)^T$
			
			Now solve for the columns of $\mathbf{H}$ by finding $T(v_1),...,T(v_2)$
			
			\begin{align*}
				T(v_1) = \sum_{k=0}^{N-1}{h(n-k)\delta(k)} = h(n) = (h_1,...,h_M,0,...,0)^T
			\end{align*}
			
			\begin{align*}
				T(v_2) = \sum_{k=0}^{N-1}{h(n-k)\delta(k-1)} = h(n-1) = (0, h_1,...,h_M,0,...,0)^T
			\end{align*}
			
			$\vdots$
			
			\begin{align*}
				T(v_N) = \sum_{k=0}^{N-1}{h(n-k)\delta(k-N)} = h(n-N) = (0, 0,...,0,h_1)^T
			\end{align*}
			
			\newpage
			$\therefore \mathbf{H}$ can be expressed as:
			
			\singlespacing
			\begin{align*}
				\mathbf{H} =
				\begin{bmatrix}
					h_1 		& 0 			& \cdots 	& 0 			& 0\\
					h_2 		& h_1 		& \cdots 	& 0 			& 0\\
					\vdots 	& \vdots 	& \ddots 	& \vdots 	& \vdots\\
					h_M 		& h_{M-1} 	& \cdots 	& 0 			& 0\\
					0 		& h_M		& \cdots 	& 0 			& 0\\
					\vdots 	& \vdots 	& \ddots 	& \vdots 	& \vdots\\
					0		& 0			& \cdots 	& h_1		& 0\\       
					0 		& 0			& \cdots 	& h_2		& h_1\\
				\end{bmatrix}
			\end{align*}
			\zerodisplayskip
			\doublespacing
		\end{enumerate}
	\end{enumerate}
\end{document}